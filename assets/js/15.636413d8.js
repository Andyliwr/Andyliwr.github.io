(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{495:function(s,n,a){"use strict";a.r(n);var t=a(4),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("最近做毕设的时候发现每次都需要输入命令启动 mongo 和 redis，还有一些爬虫和后台接口。感觉很麻烦，为什么不用 windows 上类似 shell 的 bat 语法写一个部署工具呢？")]),s._v(" "),a("h2",{attrs:{id:"截图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#截图"}},[s._v("#")]),s._v(" 截图")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://file.lantingshucheng.com/2020-08-31-22-03-27.png",alt:"主界面"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://file.lantingshucheng.com/2020-08-31-22-03-48.png",alt:"启动mongo"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://file.lantingshucheng.com/2020-08-31-22-04-13.png",alt:"console"}})]),s._v(" "),a("p",[s._v("注：图中所用软件为丑陋 cmd 的替换品 "),a("a",{attrs:{href:"https://github.com/cmderdev/cmder/releases/",target:"_blank",rel:"noopener noreferrer"}},[s._v("cmder"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("不多多说了，直接上代码吧，bat 语法大家可以自己搜索下。")]),s._v(" "),a("h2",{attrs:{id:"主进程-start-bat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主进程-start-bat"}},[s._v("#")]),s._v(" 主进程 "),a("code",[s._v("start.bat")])]),s._v(" "),a("div",{staticClass:"language-bat line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('@echo off\necho 欢迎使用FollowHeart自动化工具，%username% ....\necho 使用之前请确保mongo和redis安装地址都已经加入到到了系统环境变量里\nECHO.\n:: 公共参数设置 start\nIf %username% == Andyliwr (\n  :: 记得改成ANDYLIWRTHS\n  echo %computername%\n  If %computername% == ANDYLIWRTHS (\n     set projectAddr=C:\\Users\\Andyliwr\\Documents\\graduationDesign\n     set mongoDbPath=D:\\mongo\\data\n     set mongoLogPath=D:\\mongo\\log\\mongo.log\n     set mongoConfAddr=D:\\mongo\\mongod.conf\n     set redisConfAddr=D:\\redis\\redis.windows.conf\n  ) Else (\n     set projectAddr=C:\\Users\\Andyliwr\\Documents\\graduationDesign\n     set mongoDbPath=E:\\mongo_install\\data\n     set mongoLogPath=E:\\mongo_install\\log\\mongo.log\n     set mongoConfAddr=E:\\mongo_install\\mongod.conf\n     set redisConfAddr=E:\\redis\\redis.windows.conf\n  )\n) Else (\n  If %username% == Greenovia (\n     set projectAddr=G:\\git项目\\graduationDesign\n     set mongoDbPath=F:\\mongo\\data\n     set mongoLogPath=F:\\mongo\\log\\mongo.log\n     set mongoConfAddr=F:\\mongo\\mongod.conf\n     set redisConfAddr=F:\\redis\\redis.windows.conf\n  ) Else (\n     echo 请使用文本编辑器打开start.bar手动配置地址：\n     :: 请输入你当前的FollowHeart根目录地址:\n     set projectAddr=xxx\n     :: 请输入mongo数据存储地址(类似F:\\mongo\\data):\n     set mongoDbPath=xxx\n     :: 请输入mongo日志文件地址(类似F:\\mongo\\log\\mongo.log):\n     set mongoLogPath=xxx\n     :: 请输入mongo配置文件的地址(类似F:\\mongo\\mongod.conf):\n     set mongoConfAddr=xxx\n     :: 请输入mongo配置文件的地址(类似F:\\redis\\redis.windows.conf):\n     set redisConfAddr=xxx\n  )\n)\n:: 公共参数设置 end\n::清屏操作\nrem cls\ngoto start\n:start\n    echo --------------------------------------------------\n    echo --                FollowHeart部署               --\n    echo --  1.启动mongo和redis                          --\n    echo --  2.启动接口                                  --\n    echo --  3.排行榜爬虫                                --\n    echo --  4.百度贴吧榜爬虫                            --\n    echo --  5.启动微信小城程序                          --\n    echo --  6.新环境部署(该选项操作完成后会自动部署)    --\n    echo --  7.END                                       --\n    echo --------------------------------------------------\n    ECHO.\n    echo (请输入数字选择操作命令)\n    set /p ans=\n    if %ans%==1 goto startMongoAndRedis\n    if %ans%==2 goto startApi\n    if %ans%==3 goto startRankReptile\n    if %ans%==4 goto startBdReptile\n    if %ans%==5 goto startWechat\n    if %ans%==6 goto deploy\n    if %ans%==7 goto END\n:startMongoAndRedis\n    echo echo 正在启动redis和mongo...\n    start "启动mongo和redis" startMongoAndRedis.bat %redisConfAddr% %mongoLogPath% %mongoDbPath%\n    echo echo 已经启动redis和mongo...\n    ECHO.\n    ECHO.\n    goto start\n:startApi\n    ECHO.\n    echo 正在启动后端接口，请确保在启动接口之前已经执行过1了...\n    start "启动后端接口" startApi.bat %projectAddr%\n    echo 后端接口启动成功...\n    ECHO.\n    ECHO.\n    goto start\n:startBdReptile\n    ECHO.\n    echo 正在运行百度贴吧爬虫...\n    start "启动百度贴吧爬虫" startBdReptile.bat %projectAddr%\n    ECHO.\n    ECHO.\n    goto start\n:startRankReptile\n    ECHO.\n    echo 正在运行排行榜爬虫...\n    start "启动百度贴吧爬虫" startRankReptile.bat %projectAddr%\n    ECHO.\n    ECHO.\n    goto start\n:startWechat\n    ECHO.\n    echo 正在启动微信小程序...\n   start "启动微信小程序" startWechat.bat %projectAddr%\n    ECHO.\n    ECHO.\n    goto start\n:deploy\n    ECHO.\n    echo ----执行static项目解压操作----\n    :: 执行的逻辑命令--为bat文件传参\n    start static.bat %uatPath% %sourcePath% %sourceDisk%\n    echo ----static项目解压操作完成----\n    goto start\n:END\n    ECHO.\n    echo 退出批处理操作\npause\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br"),a("span",{staticClass:"line-number"},[s._v("114")]),a("br")])]),a("h2",{attrs:{id:"启动-redis-和-mongo-startmongoandredis-bat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动-redis-和-mongo-startmongoandredis-bat"}},[s._v("#")]),s._v(" 启动 redis 和 mongo "),a("code",[s._v("startMongoAndRedis.bat")])]),s._v(" "),a("div",{staticClass:"language-bat line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("@echo off\necho echo 正在启动redis...\nset redisConfAddr=%1\nset mongoLogPath=%2\nset mongoDbPath=%3\nredis-server.exe %redisConfAddr% --loglevel verbose\nIf errorlevel 1 (\n    echo Redis已经启动，请打开新的窗口输入redis-cli.exe开启你的管理吧...\n) Else (\n    echo Redis启动失败，请检查你配置的目录是否正确...\n)\nECHO.\necho 正在启动Mongo...\nmongod.exe --logpath=%mongoLogPath% --dbpath=%mongoDbPath% --journal --maxConns 20000\necho %errorlevel%\nIf errorlevel 1 (\n    echo Mongo已经启动，请打开新的窗口输入mongo开启你的管理吧...\n) Else (\n    echo Mongo启动失败，请检查你配置的目录是否正确...\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h2",{attrs:{id:"启动后端接口-startapi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动后端接口-startapi"}},[s._v("#")]),s._v(" 启动后端接口 "),a("code",[s._v("startApi")])]),s._v(" "),a("div",{staticClass:"language-bat line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('@echo off\nset projectAddr=%1\necho 正在启动后端接口，请确保在启动接口之前已经执行过1了...\ncd %projectAddr%/api\nIf exist node_modules (\n   echo "node包已安装..."\n) Else (\n    cnpm install\n)\nnode .\nIf errorlevel 1 (\n    echo 后端接口已经启动，请在浏览器中打开localhost:3000/explorer来查看吧...\n) Else (\n    echo 后端接口启动失败...\n)\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"启动爬虫-startbdreptile-bat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动爬虫-startbdreptile-bat"}},[s._v("#")]),s._v(" 启动爬虫 startBdReptile.bat")]),s._v(" "),a("div",{staticClass:"language-bat line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("@echo off\nset projectAddr=%1\necho 正在运行百度贴吧爬虫...\ncd %projectAddr%/reptile\nIf exist node_modules (\n   echo node包已安装...\n) Else (\n   cnpm install\n)\nnode networkReptile.js\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"踩的一些坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#踩的一些坑"}},[s._v("#")]),s._v(" 踩的一些坑")]),s._v(" "),a("p",[s._v("创建 bat 文件最好先使用系统自带的记事本创建一个文本文件，然后在另存为 bat 文件，并且设置编码为 ASNI，不然很容易中文乱码的。包括使用一些主流的编辑器如 sublime 都会出现这种问题。博主建议使用 sublime 编辑 bat 文件，毕竟有语法高亮和快捷键，写起来很方便。然后编写完了别保存直接复制到记事本中保存，这样能避免中文乱码。如果你有更好的方法，不妨在评论中回复博主。\n"),a("img",{attrs:{src:"http://img.blog.csdn.net/20170330195143921",alt:"保存编码的问题"}})]),s._v(" "),a("h2",{attrs:{id:"传送门："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#传送门："}},[s._v("#")]),s._v(" 传送门：")]),s._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"http://www.imooc.com/article/8283",target:"_blank",rel:"noopener noreferrer"}},[s._v("小白都能看懂的 windows 常用 bat 批处理命令"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://www.360doc.com/content/11/0804/10/4127803_137849318.shtml",target:"_blank",rel:"noopener noreferrer"}},[s._v("Bat 语法命令"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);n.default=e.exports}}]);